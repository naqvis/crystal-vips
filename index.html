<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="generator" content="Crystal Docs 1.6.2">
<meta name="crystal_docs.project_version" content="main">
<meta name="crystal_docs.project_name" content="vips">



<link href="css/style.css" rel="stylesheet" type="text/css" />
<script type="text/javascript" src="js/doc.js"></script>

  <meta name="repository-name" content="vips">
  <title>vips main</title>
  <script type="text/javascript">
  CrystalDocs.base_path = "";
  </script>
</head>
<body>

<svg class="hidden">
  <symbol id="octicon-link" viewBox="0 0 16 16">
    <path fill-rule="evenodd" d="M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z"></path>
  </symbol>
</svg>
<div class="sidebar">
  <div class="sidebar-header">
    <div class="search-box">
      <input type="search" class="search-input" placeholder="Search..." spellcheck="false" aria-label="Search">
    </div>

    <div class="project-summary">
      <h1 class="project-name">
        <a href="index.html">
          vips
        </a>
      </h1>

      <span class="project-version">
        main
      </span>
    </div>
  </div>

  <div class="search-results hidden">
    <ul class="search-list"></ul>
  </div>

  <div class="types-list">
    <ul>
  
  <li class="parent " data-id="vips/Vips" data-name="vips">
      <a href="Vips.html">Vips</a>
      
        <ul>
  
  <li class=" " data-id="vips/Vips/Cache" data-name="vips::cache">
      <a href="Vips/Cache.html">Cache</a>
      
    </li>
  
  <li class=" " data-id="vips/Vips/Connection" data-name="vips::connection">
      <a href="Vips/Connection.html">Connection</a>
      
    </li>
  
  <li class="parent " data-id="vips/Vips/Enums" data-name="vips::enums">
      <a href="Vips/Enums.html">Enums</a>
      
        <ul>
  
  <li class=" " data-id="vips/Vips/Enums/Access" data-name="vips::enums::access">
      <a href="Vips/Enums/Access.html">Access</a>
      
    </li>
  
  <li class=" " data-id="vips/Vips/Enums/Align" data-name="vips::enums::align">
      <a href="Vips/Enums/Align.html">Align</a>
      
    </li>
  
  <li class=" " data-id="vips/Vips/Enums/Angle" data-name="vips::enums::angle">
      <a href="Vips/Enums/Angle.html">Angle</a>
      
    </li>
  
  <li class=" " data-id="vips/Vips/Enums/Angle45" data-name="vips::enums::angle45">
      <a href="Vips/Enums/Angle45.html">Angle45</a>
      
    </li>
  
  <li class=" " data-id="vips/Vips/Enums/BandFormat" data-name="vips::enums::bandformat">
      <a href="Vips/Enums/BandFormat.html">BandFormat</a>
      
    </li>
  
  <li class=" " data-id="vips/Vips/Enums/BlendMode" data-name="vips::enums::blendmode">
      <a href="Vips/Enums/BlendMode.html">BlendMode</a>
      
    </li>
  
  <li class=" " data-id="vips/Vips/Enums/Coding" data-name="vips::enums::coding">
      <a href="Vips/Enums/Coding.html">Coding</a>
      
    </li>
  
  <li class=" " data-id="vips/Vips/Enums/Combine" data-name="vips::enums::combine">
      <a href="Vips/Enums/Combine.html">Combine</a>
      
    </li>
  
  <li class=" " data-id="vips/Vips/Enums/CombineMode" data-name="vips::enums::combinemode">
      <a href="Vips/Enums/CombineMode.html">CombineMode</a>
      
    </li>
  
  <li class=" " data-id="vips/Vips/Enums/CompassDirection" data-name="vips::enums::compassdirection">
      <a href="Vips/Enums/CompassDirection.html">CompassDirection</a>
      
    </li>
  
  <li class=" " data-id="vips/Vips/Enums/DemandStyle" data-name="vips::enums::demandstyle">
      <a href="Vips/Enums/DemandStyle.html">DemandStyle</a>
      
    </li>
  
  <li class=" " data-id="vips/Vips/Enums/Direction" data-name="vips::enums::direction">
      <a href="Vips/Enums/Direction.html">Direction</a>
      
    </li>
  
  <li class=" " data-id="vips/Vips/Enums/Extend" data-name="vips::enums::extend">
      <a href="Vips/Enums/Extend.html">Extend</a>
      
    </li>
  
  <li class=" " data-id="vips/Vips/Enums/FailOn" data-name="vips::enums::failon">
      <a href="Vips/Enums/FailOn.html">FailOn</a>
      
    </li>
  
  <li class=" " data-id="vips/Vips/Enums/ForeignDzContainer" data-name="vips::enums::foreigndzcontainer">
      <a href="Vips/Enums/ForeignDzContainer.html">ForeignDzContainer</a>
      
    </li>
  
  <li class=" " data-id="vips/Vips/Enums/ForeignDzDepth" data-name="vips::enums::foreigndzdepth">
      <a href="Vips/Enums/ForeignDzDepth.html">ForeignDzDepth</a>
      
    </li>
  
  <li class=" " data-id="vips/Vips/Enums/ForeignDzLayout" data-name="vips::enums::foreigndzlayout">
      <a href="Vips/Enums/ForeignDzLayout.html">ForeignDzLayout</a>
      
    </li>
  
  <li class=" " data-id="vips/Vips/Enums/ForeignFlags" data-name="vips::enums::foreignflags">
      <a href="Vips/Enums/ForeignFlags.html">ForeignFlags</a>
      
    </li>
  
  <li class=" " data-id="vips/Vips/Enums/ForeignHeifCompression" data-name="vips::enums::foreignheifcompression">
      <a href="Vips/Enums/ForeignHeifCompression.html">ForeignHeifCompression</a>
      
    </li>
  
  <li class=" " data-id="vips/Vips/Enums/ForeignJpegSubsample" data-name="vips::enums::foreignjpegsubsample">
      <a href="Vips/Enums/ForeignJpegSubsample.html">ForeignJpegSubsample</a>
      
    </li>
  
  <li class=" " data-id="vips/Vips/Enums/ForeignPpmFormat" data-name="vips::enums::foreignppmformat">
      <a href="Vips/Enums/ForeignPpmFormat.html">ForeignPpmFormat</a>
      
    </li>
  
  <li class=" " data-id="vips/Vips/Enums/ForeignSubsample" data-name="vips::enums::foreignsubsample">
      <a href="Vips/Enums/ForeignSubsample.html">ForeignSubsample</a>
      
    </li>
  
  <li class=" " data-id="vips/Vips/Enums/ForeignTiffCompression" data-name="vips::enums::foreigntiffcompression">
      <a href="Vips/Enums/ForeignTiffCompression.html">ForeignTiffCompression</a>
      
    </li>
  
  <li class=" " data-id="vips/Vips/Enums/ForeignTiffPredictor" data-name="vips::enums::foreigntiffpredictor">
      <a href="Vips/Enums/ForeignTiffPredictor.html">ForeignTiffPredictor</a>
      
    </li>
  
  <li class=" " data-id="vips/Vips/Enums/ForeignTiffResunit" data-name="vips::enums::foreigntiffresunit">
      <a href="Vips/Enums/ForeignTiffResunit.html">ForeignTiffResunit</a>
      
    </li>
  
  <li class=" " data-id="vips/Vips/Enums/ForeignWebpPreset" data-name="vips::enums::foreignwebppreset">
      <a href="Vips/Enums/ForeignWebpPreset.html">ForeignWebpPreset</a>
      
    </li>
  
  <li class=" " data-id="vips/Vips/Enums/ImageType" data-name="vips::enums::imagetype">
      <a href="Vips/Enums/ImageType.html">ImageType</a>
      
    </li>
  
  <li class=" " data-id="vips/Vips/Enums/Intent" data-name="vips::enums::intent">
      <a href="Vips/Enums/Intent.html">Intent</a>
      
    </li>
  
  <li class=" " data-id="vips/Vips/Enums/Interesting" data-name="vips::enums::interesting">
      <a href="Vips/Enums/Interesting.html">Interesting</a>
      
    </li>
  
  <li class=" " data-id="vips/Vips/Enums/Interpretation" data-name="vips::enums::interpretation">
      <a href="Vips/Enums/Interpretation.html">Interpretation</a>
      
    </li>
  
  <li class=" " data-id="vips/Vips/Enums/Kernel" data-name="vips::enums::kernel">
      <a href="Vips/Enums/Kernel.html">Kernel</a>
      
    </li>
  
  <li class=" " data-id="vips/Vips/Enums/OperationBoolean" data-name="vips::enums::operationboolean">
      <a href="Vips/Enums/OperationBoolean.html">OperationBoolean</a>
      
    </li>
  
  <li class=" " data-id="vips/Vips/Enums/OperationComplex" data-name="vips::enums::operationcomplex">
      <a href="Vips/Enums/OperationComplex.html">OperationComplex</a>
      
    </li>
  
  <li class=" " data-id="vips/Vips/Enums/OperationComplex2" data-name="vips::enums::operationcomplex2">
      <a href="Vips/Enums/OperationComplex2.html">OperationComplex2</a>
      
    </li>
  
  <li class=" " data-id="vips/Vips/Enums/OperationComplexget" data-name="vips::enums::operationcomplexget">
      <a href="Vips/Enums/OperationComplexget.html">OperationComplexget</a>
      
    </li>
  
  <li class=" " data-id="vips/Vips/Enums/OperationFlags" data-name="vips::enums::operationflags">
      <a href="Vips/Enums/OperationFlags.html">OperationFlags</a>
      
    </li>
  
  <li class=" " data-id="vips/Vips/Enums/OperationMath" data-name="vips::enums::operationmath">
      <a href="Vips/Enums/OperationMath.html">OperationMath</a>
      
    </li>
  
  <li class=" " data-id="vips/Vips/Enums/OperationMath2" data-name="vips::enums::operationmath2">
      <a href="Vips/Enums/OperationMath2.html">OperationMath2</a>
      
    </li>
  
  <li class=" " data-id="vips/Vips/Enums/OperationMorphology" data-name="vips::enums::operationmorphology">
      <a href="Vips/Enums/OperationMorphology.html">OperationMorphology</a>
      
    </li>
  
  <li class=" " data-id="vips/Vips/Enums/OperationRelational" data-name="vips::enums::operationrelational">
      <a href="Vips/Enums/OperationRelational.html">OperationRelational</a>
      
    </li>
  
  <li class=" " data-id="vips/Vips/Enums/OperationRound" data-name="vips::enums::operationround">
      <a href="Vips/Enums/OperationRound.html">OperationRound</a>
      
    </li>
  
  <li class=" " data-id="vips/Vips/Enums/PCS" data-name="vips::enums::pcs">
      <a href="Vips/Enums/PCS.html">PCS</a>
      
    </li>
  
  <li class=" " data-id="vips/Vips/Enums/Precision" data-name="vips::enums::precision">
      <a href="Vips/Enums/Precision.html">Precision</a>
      
    </li>
  
  <li class=" " data-id="vips/Vips/Enums/RegionShrink" data-name="vips::enums::regionshrink">
      <a href="Vips/Enums/RegionShrink.html">RegionShrink</a>
      
    </li>
  
  <li class=" " data-id="vips/Vips/Enums/Saveable" data-name="vips::enums::saveable">
      <a href="Vips/Enums/Saveable.html">Saveable</a>
      
    </li>
  
  <li class=" " data-id="vips/Vips/Enums/Signal" data-name="vips::enums::signal">
      <a href="Vips/Enums/Signal.html">Signal</a>
      
    </li>
  
  <li class=" " data-id="vips/Vips/Enums/Size" data-name="vips::enums::size">
      <a href="Vips/Enums/Size.html">Size</a>
      
    </li>
  
  <li class=" " data-id="vips/Vips/Enums/Token" data-name="vips::enums::token">
      <a href="Vips/Enums/Token.html">Token</a>
      
    </li>
  
</ul>

      
    </li>
  
  <li class=" " data-id="vips/Vips/GObject" data-name="vips::gobject">
      <a href="Vips/GObject.html">GObject</a>
      
    </li>
  
  <li class=" " data-id="vips/Vips/GValue" data-name="vips::gvalue">
      <a href="Vips/GValue.html">GValue</a>
      
    </li>
  
  <li class="parent " data-id="vips/Vips/Image" data-name="vips::image">
      <a href="Vips/Image.html">Image</a>
      
        <ul>
  
  <li class=" " data-id="vips/Vips/Image/EvalProc" data-name="vips::image::evalproc">
      <a href="Vips/Image/EvalProc.html">EvalProc</a>
      
    </li>
  
</ul>

      
    </li>
  
  <li class=" " data-id="vips/Vips/Interpolate" data-name="vips::interpolate">
      <a href="Vips/Interpolate.html">Interpolate</a>
      
    </li>
  
  <li class="parent " data-id="vips/Vips/Introspect" data-name="vips::introspect">
      <a href="Vips/Introspect.html">Introspect</a>
      
        <ul>
  
  <li class=" " data-id="vips/Vips/Introspect/Argument" data-name="vips::introspect::argument">
      <a href="Vips/Introspect/Argument.html">Argument</a>
      
    </li>
  
</ul>

      
    </li>
  
  <li class=" " data-id="vips/Vips/MutableImage" data-name="vips::mutableimage">
      <a href="Vips/MutableImage.html">MutableImage</a>
      
    </li>
  
  <li class=" " data-id="vips/Vips/Operation" data-name="vips::operation">
      <a href="Vips/Operation.html">Operation</a>
      
    </li>
  
  <li class=" " data-id="vips/Vips/Region" data-name="vips::region">
      <a href="Vips/Region.html">Region</a>
      
    </li>
  
  <li class=" " data-id="vips/Vips/Source" data-name="vips::source">
      <a href="Vips/Source.html">Source</a>
      
    </li>
  
  <li class=" " data-id="vips/Vips/SourceCustom" data-name="vips::sourcecustom">
      <a href="Vips/SourceCustom.html">SourceCustom</a>
      
    </li>
  
  <li class=" " data-id="vips/Vips/SourceStream" data-name="vips::sourcestream">
      <a href="Vips/SourceStream.html">SourceStream</a>
      
    </li>
  
  <li class=" " data-id="vips/Vips/Stats" data-name="vips::stats">
      <a href="Vips/Stats.html">Stats</a>
      
    </li>
  
  <li class=" " data-id="vips/Vips/Target" data-name="vips::target">
      <a href="Vips/Target.html">Target</a>
      
    </li>
  
  <li class=" " data-id="vips/Vips/TargetCustom" data-name="vips::targetcustom">
      <a href="Vips/TargetCustom.html">TargetCustom</a>
      
    </li>
  
  <li class=" " data-id="vips/Vips/TargetStream" data-name="vips::targetstream">
      <a href="Vips/TargetStream.html">TargetStream</a>
      
    </li>
  
  <li class=" " data-id="vips/Vips/Type" data-name="vips::type">
      <a href="Vips/Type.html">Type</a>
      
    </li>
  
  <li class=" " data-id="vips/Vips/VipsBlob" data-name="vips::vipsblob">
      <a href="Vips/VipsBlob.html">VipsBlob</a>
      
    </li>
  
  <li class=" " data-id="vips/Vips/VipsException" data-name="vips::vipsexception">
      <a href="Vips/VipsException.html">VipsException</a>
      
    </li>
  
  <li class=" " data-id="vips/Vips/VipsObject" data-name="vips::vipsobject">
      <a href="Vips/VipsObject.html">VipsObject</a>
      
    </li>
  
</ul>

      
    </li>
  
</ul>

  </div>
</div>


<div class="main-content">
<h1><a id="crystal-vips" class="anchor" href="#crystal-vips">  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>CrystalVips</h1>
<p><a href="https://github.com/naqvis/crystal-vips/actions/workflows/ci.yml"><img src="https://github.com/naqvis/crystal-vips/actions/workflows/ci.yml/badge.svg" alt="crystal-vips CI" /></a>
<a href="https://github.com/naqvis/crystal-vips/releases"><img src="https://img.shields.io/github/release/naqvis/crystal-vips.svg" alt="Latest release" /></a>
<a href="https://naqvis.github.io/crystal-vips/"><img src="https://img.shields.io/badge/docs-available-brightgreen.svg" alt="Docs" /></a></p>
<p>Provides Crystal language interface to the <a href="https://github.com/libvips/libvips">libvips</a> image processing library.
Programs that use <code>CrystalVips</code> don't manipulate images directly, instead they create pipelines of image processing operations starting from a source image. When the pipe is connected to a destination, the whole pipeline executes at once and in parallel, streaming the image from source to destination in a set of small fragments.</p>
<p>Because <code>CrystalVips</code> is parallel, its' quick, and because it doesn't need to keep entire images in memory, its light. For example, the libvips speed and memory use benchmark:</p>
<p><a href="https://github.com/libvips/libvips/wiki/Speed-and-memory-use">https://github.com/libvips/libvips/wiki/Speed-and-memory-use</a></p>
<h2><a id="pre-requisites" class="anchor" href="#pre-requisites">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Pre-requisites</h2>
<p>You need to <a href="https://www.libvips.org/install.html">install the libvips
library</a>. It's in the linux package managers, homebrew and MacPorts, and there are Windows binaries on the vips website. For example, on Debian:</p>
<pre><code class="language-crystal">sudo apt-get install --no-install-recommends libvips42</code></pre>
<p>(<code>--no-install-recommends</code> stops Debian installing a <em>lot</em> of extra packages)</p>
<p>Or macOS:</p>
<pre><code class="language-crystal">brew install vips</code></pre>
<h2><a id="installation" class="anchor" href="#installation">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Installation</h2>
<ol>
<li>
<p>Add the dependency to your <code>shard.yml</code>:</p>
<pre><code class="language-yaml">dependencies:
  vips:
    github: naqvis/crystal-vips</code></pre>
</li>
<li>
<p>Run <code>shards install</code></p>
</li>
</ol>
<h2><a id="usage" class="anchor" href="#usage">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Usage</h2>
<pre><code class="language-crystal"><span class="k">require</span> <span class="s">&quot;vips&quot;</span>

im <span class="o">=</span> <span class="t">Vips</span><span class="t">::</span><span class="t">Image</span>.new_from_file(<span class="s">&quot;image.jpg&quot;</span>)

<span class="c"># put im at position (100, 100) in a 3000 x 3000 pixel image, </span>
<span class="c"># make the other pixels in the image by mirroring im up / down / </span>
<span class="c"># left / right, see</span>
<span class="c"># https://libvips.github.io/libvips/API/current/libvips-conversion.html#vips-embed</span>
im <span class="o">=</span> im.embed(<span class="n">100</span>, <span class="n">100</span>, <span class="n">3000</span>, <span class="n">3000</span>, <span class="k">extend</span>: <span class="t">Vips</span><span class="t">::</span><span class="t">Enums</span><span class="t">::</span><span class="t">Extend</span><span class="t">::</span><span class="t">Mirror</span>)

<span class="c"># multiply the green (middle) band by 2, leave the other two alone</span>
im <span class="o">*=</span> [<span class="n">1</span>, <span class="n">2</span>, <span class="n">1</span>]

<span class="c"># make an image from an array constant, convolve with it</span>
mask <span class="o">=</span> <span class="t">Vips</span><span class="t">::</span><span class="t">Image</span>.new_from_array([
    [<span class="n">-1</span>, <span class="n">-1</span>, <span class="n">-1</span>],
    [<span class="n">-1</span>, <span class="n">16</span>, <span class="n">-1</span>],
    [<span class="n">-1</span>, <span class="n">-1</span>, <span class="n">-1</span>]], <span class="n">8</span>)
im <span class="o">=</span> im.conv(mask, precision: <span class="t">Vips</span><span class="t">::</span><span class="t">Enums</span><span class="t">::</span><span class="t">Precision</span><span class="t">::</span><span class="t">Integer</span>)

<span class="c"># finally, write the result back to a file on disk</span>
im.write_to_file(<span class="s">&quot;output.jpg&quot;</span>)</code></pre>
<p>Refer to <a href="example">example</a> folder for more samples</p>
<h2><a id="development" class="anchor" href="#development">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Development</h2>
<p>To run all tests:</p>
<pre><code class="language-crystal">crystal spec</code></pre>
<h1><a id="getting-more-help" class="anchor" href="#getting-more-help">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Getting more help</h1>
<p>The libvips website has a handy table of <a href="http://libvips.github.io/libvips/API/current/func-list.html">all the libvips
operators</a>. Each
one links to the main API docs so you can see what you need to pass to it.</p>
<p>A simple way to see the arguments for an operation is to try running it
from the command-line. For example:</p>
<pre><code class="language-bash">$ vips embed
embed an image in a larger image
usage:
   embed in out x y width height
where:
   in           - Input image, input VipsImage
   out          - Output image, output VipsImage
   x            - Left edge of input in output, input gint
			default: 0
			min: -1000000000, max: 1000000000
   y            - Top edge of input in output, input gint
			default: 0
			min: -1000000000, max: 1000000000
   width        - Image width in pixels, input gint
			default: 1
			min: 1, max: 1000000000
   height       - Image height in pixels, input gint
			default: 1
			min: 1, max: 1000000000
optional arguments:
   extend       - How to generate the extra pixels, input VipsExtend
			default: black
			allowed: black, copy, repeat, mirror, white, background
   background   - Color for background pixels, input VipsArrayDouble
operation flags: sequential </code></pre>
<h2><a id="contributing" class="anchor" href="#contributing">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Contributing</h2>
<ol>
<li>Fork it (<a href="https://github.com/naqvis/crystal-vips/fork">https://github.com/naqvis/crystal-vips/fork</a>)</li>
<li>Create your feature branch (<code>git checkout -b my-new-feature</code>)</li>
<li>Commit your changes (<code>git commit -am 'Add some feature'</code>)</li>
<li>Push to the branch (<code>git push origin my-new-feature</code>)</li>
<li>Create a new Pull Request</li>
</ol>
<h2><a id="contributors" class="anchor" href="#contributors">
  <svg class="octicon-link" aria-hidden="true">
    <use href="#octicon-link"/>
  </svg>
</a>Contributors</h2>
<ul>
<li><a href="https://github.com/naqvis">Ali Naqvi</a> - creator and maintainer</li>
</ul>
</div>
</body>
</html>
